[build]
  command = "pnpm install && vite build"
  publish = "dist/public"
  functions = "netlify/functions"

[build.environment]
  NODE_VERSION = "20"
  # Client-side environment variables (VITE_* prefix required)
  VITE_APP_ID = "proj_abc123def456"
  VITE_OAUTH_PORTAL_URL = "https://vida.butterfly-effect.dev"
  VITE_APP_TITLE = "TamerX Inventory"
  VITE_APP_LOGO = "https://placehold.co/40x40/3b82f6/ffffff?text=T"
  VITE_SUPABASE_URL = "https://nybjrfxjgiirgiplsixi.supabase.co"
  VITE_SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im55YmpyZnhqZ2lpcmdpcGxzaXhpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3MDg3NzUsImV4cCI6MjA3NzI4NDc3NX0.CIE66jPR_ZnkoyYmjcW6PTb7PtOt0aYV7039wy-Au24"

# Redirect API requests to serverless function
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/server"
  status = 200

# SPA fallback - serve index.html for all other routes
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
